---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# funneljoin

The goal of funneljoin is to make it easy to analyze behavior funnels. For example, maybe you're interested in finding the people who visit a page and then register. Or you want all the times people click on an item and add it to their cart within 2 days. 

You can do this with funneljoin's `after_join()` function. The arguments are: 
- `x`: a dataset with the first set of behaviors.
- `y`: a dataset with the second set of behaviors.
- `by_time`: a character vector to specify the time columns in x and y. Must be a single column in each tbl. Note that this column is used to filter for time y >= time x.
- `by_user`: a character vector to specify the user or identity columns in x and y. Must be a single column in each tbl.
- `mode`: the method used to join: "inner", "full", "anti", "semi", "right", "left".
- `type`: the type of funnel used to distinguish between event pairs, such as "first-first", "last-first", "any-firstafter". See types of funnels.
- `dt` (optional): if doing a gap join, either the number of seconds between events or a difftime object. 

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("datacamp/funneljoin")
```

## Example

## Rules 
- If type_x is "last" or "first", then a right join has the same number of rows as y.
- If type_y is "last", "first", or "firstafter", then a left join has the same number of rows as x. 

## Types of funnels
* first-first: Take the earliest x and y for each user **before** joining (e.g. entered an experiment, then registered)
* first-firstafter: Take the first x, then the first y after that (e.g. entered an experiment, then started a course)
* lastbefore-firstafter: First x that's followed by a y before the next x (e.g. last click paid ad attribution)
* last-firstafter: Take the last X **before** joining followed by the first Y afterward
* any-firstafter: Take all Xs followed by the first Y after it.
* any-any: Take all Xs followed by all Ys.

Gaps: 
* smallestgap: Take the smallest x-y gap (in tie, earliest).
* withingap: Take all x-y pairs with a gap of less than dt (all ad clicks followed by a course start within an hour). 





